1) List all the books that are written by Author Loni and has price
less then 600.?

mysql> select Book_name from books where Author="loni" and cost<=600;
+-----------------------+
| Book_name             |
+-----------------------+
| Oracle - Complete Ref |
| Mastering SQL         |
+-----------------------+
2 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2) List the Issue details for the books that are not returned yet.?

mysql> select * from issue where return_date=Null;
Empty set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

3) Update all the blank return_date with 31-Dec-06 excluding 7005and 7006.?

mysql> Update issue set return_date = '2006-12-31' where return_date is Null and lib_Issue_Id Not in (7005,7006);
Query OK, 0 rows affected (0.01 sec)
Rows matched: 0  Changed: 0  Warnings: 0

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4) List all the Issue details that have books issued for more then 30 days.?

mysql> select * from issue where DATEDIFF(issue_date,return_date)>=30;
Empty set (0.00 sec)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

5) List all the books that have price in range of 500 to 750 and has
category as Database.?

mysql> select Book_name from books where cost between 550 and 750 and Category="Database";
+-----------------------+
| Book_name             |
+-----------------------+
| Oracle - Complete Ref |
| PL SQL-Ref            |
+-----------------------+
2 rows in set (0.00 sec)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6) List all the books that belong to any one of the following
categories Science, Database, Fiction, Management.?

mysql> table books;
+---------+-----------------------+----------------+------+----------+
| Book_No | Book_Name             | Author         | cost | Category |
+---------+-----------------------+----------------+------+----------+
|     101 | Let us C              | Dennis Ritchie |  450 | System   |
|     102 | Oracle - Complete Ref | Loni           |  550 | Database |
|     103 | Mastering SQL         | Loni           |  250 | Database |
|     104 | PL SQL-Ref            | Scott Urman    |  750 | Database |
+---------+-----------------------+----------------+------+----------+
4 rows in set (0.00 sec)

mysql> select Book_name from books Where Category in("Science","Fiction","Database","Management");
+-----------------------+
| Book_name             |
+-----------------------+
| Oracle - Complete Ref |
| Mastering SQL         |
| PL SQL-Ref            |
+-----------------------+
3 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

7) List all the members in the descending order of Penalty due on them?

mysql> table member;
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         4 | Kuldip Singh | Punjab         | 2026-11-15    | Quaterly        |     13400 |                 2 |          40.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
6 rows in set (0.00 sec)

mysql> select Member_name from member where Penalty_Amount is Not Null order by Penalty_Amount desc;
+--------------+
| Member_name  |
+--------------+
| Richa Sharma |
| Mohit Sharma |
| Kuldip Singh |
| Akshar Patel |
| Rajiv Patel  |
+--------------+
5 rows in set (0.00 sec)

8) Modify the price of book with id 103 to Rs 300 and category to RDBMS.?

mysql> table books;
+---------+-----------------------+----------------+------+----------+
| Book_No | Book_Name             | Author         | cost | Category |
+---------+-----------------------+----------------+------+----------+
|     101 | Let us C              | Dennis Ritchie |  450 | System   |
|     102 | Oracle - Complete Ref | Loni           |  550 | Database |
|     103 | Mastering SQL         | Loni           |  250 | Database |
|     104 | PL SQL-Ref            | Scott Urman    |  750 | Database |
+---------+-----------------------+----------------+------+----------+
4 rows in set (0.00 sec)

mysql> update books set cost=300 where Book_no=103;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> update books set Category="RDBMS" where Book_no=103;
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> table books;
+---------+-----------------------+----------------+------+----------+
| Book_No | Book_Name             | Author         | cost | Category |
+---------+-----------------------+----------------+------+----------+
|     101 | Let us C              | Dennis Ritchie |  450 | System   |
|     102 | Oracle - Complete Ref | Loni           |  550 | Database |
|     103 | Mastering SQL         | Loni           |  300 | RDBMS    |
|     104 | PL SQL-Ref            | Scott Urman    |  750 | Database |
+---------+-----------------------+----------------+------+----------+
4 rows in set (0.00 sec)

9) List all the books in ascending order of category and descending  order of price.?

mysql> select book_name,cost,Category from books order by Category asc,cost desc;
+-----------------------+------+----------+
| book_name             | cost | Category |
+-----------------------+------+----------+
| PL SQL-Ref            |  750 | Database |
| Oracle - Complete Ref |  550 | Database |
| Mastering SQL         |  300 | RDBMS    |
| Let us C              |  450 | System   |
+-----------------------+------+----------+
4 rows in set (0.00 sec)

10) List all the books that contain word SQL in the name of the book.?

mysql> select Book_name from books where Book_name like '%SQL%';
+---------------+
| Book_name     |
+---------------+
| Mastering SQL |
| PL SQL-Ref    |
+---------------+
2 rows in set (0.00 sec)


11) List the Lib_Issue_Id, Issue_Date, Return_Date and No of days Book was issued.?

mysql> select Lib_Issue_Id,issue_date,return_date ,Datediff(return_date,issue_date) as No_of_days from issue;
+--------------+------------+-------------+------------+
| Lib_Issue_Id | issue_date | return_date | No_of_days |
+--------------+------------+-------------+------------+
|         7001 | 2006-12-10 | 2006-12-10  |          0 |
|         7002 | 2006-12-25 | 2006-12-28  |          3 |
|         7003 | 2006-12-15 | 2006-12-18  |          3 |
|         7005 | 2006-11-15 | 2006-11-18  |          3 |
|         7006 | 2006-02-18 | 2006-02-21  |          3 |
+--------------+------------+-------------+------------+
5 rows in set (0.00 sec)



12) Find the details of the member of the Library in the order of their joining the library.?
mysql> table member;

+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         4 | Kuldip Singh | Punjab         | 2026-11-15    | Quaterly        |     13400 |                 2 |          40.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
6 rows in set (0.00 sec)

mysql> select * from member order by Acc_Open_Date;
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
|         4 | Kuldip Singh | Punjab         | 2026-11-15    | Quaterly        |     13400 |                 2 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
6 rows in set (0.00 sec)


13) Display the count of total no of books issued to Member =1?

mysql> select member_Id,count(Book_no) from issue where member_Id=1;
+-----------+----------------+
| member_Id | count(Book_no) |
+-----------+----------------+
|         1 |              2 |
+-----------+----------------+
1 row in set (0.00 sec)


14) Display the total penalty due for all the members.?

mysql> select sum(Penalty_Amount) as total_penalty_amount from member;
+----------------------+
| total_penalty_amount |
+----------------------+
|               210.00 |
+----------------------+
1 row in set (0.00 sec)


15) Display the total no of members?

mysql> select count(member_id) as total_members from member;
+---------------+
| total_members |
+---------------+
|             6 |
+---------------+
1 row in set (0.01 sec)


16) Display the total no of books issued?

mysql> select count(lib_Issue_Id) as total_no_of_Books_issued from issue;
+--------------------------+
| total_no_of_Books_issued |
+--------------------------+
|                        5 |
+--------------------------+
1 row in set (0.00 sec)


17) Display the average membership fees paid by all the members

mysql> select avg(fess_paid) as average_fees_paid from member;
+-------------------+
| average_fees_paid |
+-------------------+
|        13200.0000 |
+-------------------+
1 row in set (0.00 sec)


18) List the various categories and count of books in each category.?

mysql> select category,count(category) from books group by category;
+----------+-----------------+
| category | count(category) |
+----------+-----------------+
| System   |               1 |
| Database |               2 |
| RDBMS    |               1 |
+----------+-----------------+
3 rows in set (0.00 sec)


19) List the book_No and the number of times the book is issued in the
descending order of count.?

mysql> select Book_no,count(Book_no) from issue group by Book_no order by count(Book_no) desc;
+---------+----------------+
| Book_no | count(Book_no) |
+---------+----------------+
|     104 |              3 |
|     101 |              1 |
|     102 |              1 |
+---------+----------------+
3 rows in set (0.00 sec)


20) Find the maximum, minimum, total and average penalty amount in
the member table.?

mysql> select max(Penalty_Amount),min(Penalty_Amount),avg(Penalty_Amount),sum(Penalty_Amount) from member;
+---------------------+---------------------+---------------------+---------------------+
| max(Penalty_Amount) | min(Penalty_Amount) | avg(Penalty_Amount) | sum(Penalty_Amount) |
+---------------------+---------------------+---------------------+---------------------+
|               50.00 |               40.00 |           42.000000 |              210.00 |
+---------------------+---------------------+---------------------+---------------------+


21) Display the member id and the no of books for each member that has issued more then 2 books.?

mysql> table issue;
+--------------+-----------+---------+------------+-------------+
| lib_Issue_Id | member_Id | Book_no | issue_date | return_date |
+--------------+-----------+---------+------------+-------------+
|         7001 |         1 |     101 | 2006-12-10 | 2006-12-10  |
|         7002 |         2 |     102 | 2006-12-25 | 2006-12-28  |
|         7003 |         1 |     104 | 2006-12-15 | 2006-12-18  |
|         7005 |         2 |     104 | 2006-11-15 | 2006-11-18  |
|         7006 |         3 |     104 | 2006-02-18 | 2006-02-21  |
+--------------+-----------+---------+------------+-------------+
5 rows in set (0.00 sec)


mysql> select member_id,count(book_no) from issue group by member_id having count(Book_no)>2;
Empty set (0.00 sec)

22) Display the member id, book no and no of times the same book is
issued by the member in the descending order of count.?
mysql> select member_Id,Book_no,count(Book_no) from issue group by member_Id,Book_no order by count(Book_no) desc;

+-----------+---------+----------------+
| member_Id | Book_no | count(Book_no) |
+-----------+---------+----------------+
|         1 |     101 |              1 |
|         2 |     102 |              1 |
|         1 |     104 |              1 |
|         2 |     104 |              1 |
|         3 |     104 |              1 |
+-----------+---------+----------------+
5 rows in set (0.00 sec)

23) Display the month and no of books issued each month in the
descending order of count.?
issue

mysql> select month(issue_date),count(Book_no) from issue  group by month(issue_date) order by count(Book_no) desc;
+-------------------+----------------+
| month(issue_date) | count(Book_no) |
+-------------------+----------------+
|                12 |              3 |
|                11 |              1 |
|                 2 |              1 |
+-------------------+----------------+
3 rows in set (0.00 sec)


24) List the book_no of all the books that are not issued to anymember so far.?

mysql> select book_no from books where book_no not in (select book_no from issue);
+---------+
| book_no |
+---------+
|     103 |
+---------+
1 row in set (0.00 sec)


25) List all the member id that exist in member table and has also at
least one book issued by them.?

mysql> select Member_Id from member where Member_Id in (select member_id from issue);
+-----------+
| Member_Id |
+-----------+
|         1 |
|         2 |
|         3 |
+-----------+
3 rows in set (0.00 sec)

26) List the member ID with highest and lowest no of books issued.?

Ans: mysql> select m.member_id,count(Book_no),i.Book_no from member as m right join issue as i on m.member_id=i.member_id group by i.Book_no,m.member_id;
+-----------+----------------+---------+
| member_id | count(Book_no) | Book_no |
+-----------+----------------+---------+
|         1 |              1 |     101 |
|         2 |              1 |     102 |
|         1 |              1 |     104 |
|         2 |              1 |     104 |
|         3 |              1 |     104 |
+-----------+----------------+---------+
5 rows in set (0.00 sec)



27) List all the Issue_details for books issued in December and July without using any arithmetic, Logical or comparison operator.?

mysql> select *
    -> from issue
    -> where  FIND_IN_SET(MONTHNAME(Issue_date), 'December,July');
+--------------+-----------+---------+------------+-------------+
| lib_Issue_Id | member_Id | Book_no | issue_date | return_date |
+--------------+-----------+---------+------------+-------------+
|         7001 |         1 |     101 | 2006-12-10 | 2006-12-10  |
|         7002 |         2 |     102 | 2006-12-25 | 2006-12-28  |
|         7003 |         1 |     104 | 2006-12-15 | 2006-12-18  |
+--------------+-----------+---------+------------+-------------+
3 rows in set (0.00 sec)


28) List the Book_No, Book_Name and Issue_date for all the books
that are issued in month of December and belong to category Database.?

mysql> select book_no, book_name, cost
    -> from books
    -> where  category = 'Database'
    -> and book_no IN (
    ->     select book_no
    ->     from issue
    ->     where month(issue_date) = 12
    -> );
+---------+-----------------------+------+
| book_no | book_name             | cost |
+---------+-----------------------+------+
|     102 | Oracle - Complete Ref |  550 |
|     104 | PL SQL-Ref            |  750 |
+---------+-----------------------+------+
2 rows in set (0.00 sec)


29) List the Member Id, Member Name and max books allowed in the
descending order of the max books allowed?

mysql> select Member_id,Member_Name,Max_Books_Allowed from member order by Max_Books_Allowed desc;
+-----------+--------------+-------------------+
| Member_id | Member_Name  | Max_Books_Allowed |
+-----------+--------------+-------------------+
|         6 | Rajiv Patel  |               110 |
|         1 | Richa Sharma |                 5 |
|         3 | Mohit Sharma |                 4 |
|         2 | Garima Sen   |                 3 |
|         4 | Kuldip Singh |                 2 |
|         5 | Akshar Patel |                 2 |
+-----------+--------------+-------------------+
6 rows in set (0.00 sec)

30) List the Book No, Book Name, Issue_date and Return_Date for all
the books issued by Richa Sharma?

SELECT 
    b.book_no,
    b.book_name,
    i.issue_date,
    i.return_date
FROM member m
JOIN issue i 
    ON m.member_id = i.member_id
JOIN books b 
    ON i.book_no = b.book_no
WHERE m.member_name = 'Richa Sharma';



31) List the details of all the members that have issued books in
Database category ?

mysql> select * from member where member_id in(select i.member_id from issue i where i.book_no in (select b.book_no  from books b where b.category ="Database"));
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
3 rows in set (0.00 sec)


32) List all the books that have highest price in their own category.?

mysql> select * from books as b1 where cost=(select max(cost) from books as b2 where b2.category=b1.category);
+---------+---------------+----------------+------+----------+
| Book_No | Book_Name     | Author         | cost | Category |
+---------+---------------+----------------+------+----------+
|     101 | Let us C      | Dennis Ritchie |  450 | System   |
|     103 | Mastering SQL | Loni           |  300 | RDBMS    |
|     104 | PL SQL-Ref    | Scott Urman    |  750 | Database |
+---------+---------------+----------------+------+----------+
3 rows in set (0.00 sec)

33) List all the Issue_Details where Issue_date is not within the
Acc_open_date and Return_date for that member?

Ans:  SELECT i.*
FROM issue i
JOIN member m
  ON m.member_id = i.member_id
WHERE i.issue_date NOT BETWEEN m.acc_open_date;



34) List all the members that have not issued a single book so far.?

mysql> select Member_id from member where Member_id not in(select member_Id from issue);
+-----------+
| Member_id |
+-----------+
|         4 |
|         5 |
|         6 |
+-----------+
3 rows in set (0.00 sec)


35) List all the members that have issued the same book as issued by  Garima.?

mysql> selecet *
    -> from member
    -> where Member_ID IN (
    ->     select i.Member_ID
    ->     from issue i
    ->     where  i.Book_no = 102
    -> )
    -> and Member_Name = 'Garima Sen';
+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         2 | Garima Sen  | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
1 row in set (0.01 sec)



36)  List the Book_Name, Price of all the books that are not returned
for more then 30 days.?
Ans:
 select Book_name,cost from books as b right join issue as i on b.Book_no=i.Book_no where  DATEDIFF(return_date, issue_date) >30;
Empty set (0.00 sec)


37) List all the authors and book_name that has more then 1 book?
written by them.?

mysql> SELECT b.author, b.book_name
    -> FROM books b
    -> JOIN (
    ->     SELECT author
    ->     FROM books
    ->     GROUP BY author
    ->     HAVING COUNT(*) > 1
    -> ) a ON b.author = a.author
    -> ORDER BY b.author;
+--------+-----------------------+
| author | book_name             |
+--------+-----------------------+
| Loni   | Oracle - Complete Ref |
| Loni   | Mastering SQL         |
+--------+-----------------------+
2 rows in set (0.01 sec)

38) List the Member ID, Member Name of the people that have issued
the highest and the lowest no of books?
Ans: 
	 select m.member_id, m.member_name, t.total_books
    -> from member m
    -> join (
    ->     select member_id, COUNT(*) AS total_books
    ->     from issue
    ->     group by member_id
    -> ) t on m.member_id = t.member_id
    -> where t.total_books = (
    ->         select max(cnt)
    ->         FROM (
    ->             select count(*) as cnt
    ->             from issue
    ->             group by member_id
    ->         ) x
    ->      )
    ->    or t.total_books = (
    ->         select min(cnt)
    ->         from (
    ->             select count(*) as cnt
    ->             from issue
    ->             group by member_id
    ->         ) y
    ->      );
+-----------+--------------+-------------+
| member_id | member_name  | total_books |
+-----------+--------------+-------------+
|         1 | Richa Sharma |           2 |
|         2 | Garima Sen   |           2 |
|         3 | Mohit Sharma |           1 |
+-----------+--------------+-------------+
3 rows in set (0.00 sec)




39) List the details of highest 3 priced books?
mysql> select*
    -> from books
    -> order by  cost desc
    -> limit 3;
+---------+-----------------------+----------------+------+----------+
| Book_No | Book_Name             | Author         | cost | Category |
+---------+-----------------------+----------------+------+----------+
|     104 | PL SQL-Ref            | Scott Urman    |  750 | Database |
|     102 | Oracle - Complete Ref | Loni           |  550 | Database |
|     101 | Let us C              | Dennis Ritchie |  450 | System   |
+---------+-----------------------+----------------+------+----------+
3 rows in set (0.00 sec)

40) List the total cost of all the books that are currently issued but not
returned?

mysql> SELECT SUM(cost) AS Total_Cost
    -> FROM books
    -> WHERE Book_no IN (
    ->     SELECT Book_no
    ->     FROM issue
    ->     WHERE Return_date IS NULL
    -> );
+------------+
| Total_Cost |
+------------+
|       NULL |
+------------+
1 row in set (0.00 sec)



41) List the details of the book that has been issued maximum no of
times?

mysql> select Book_No,count(Book_no) from issue group by Book_no having count(Book_no)>1;
+---------+----------------+
| Book_No | count(Book_no) |
+---------+----------------+
|     104 |              3 |
+---------+----------------+
1 row in set (0.00 sec)


mysql> select * from Books where Book_no =(select i.Book_No from issue as i group by Book_no order by count(*) desc limit 1);
+---------+------------+-------------+------+----------+
| Book_No | Book_Name  | Author      | cost | Category |
+---------+------------+-------------+------+----------+
|     104 | PL SQL-Ref | Scott Urman |  750 | Database |
+---------+------------+-------------+------+----------+
1 row in set (0.00 sec)

42) List how many books are issued to lifetime members.?
Ans:  

mysql> select m.member_id,count(Book_no),i.Book_no, Membership_type from member as m right join issue as i on m.member_id=i.member_id
    ->  where m.membership_type="lifetime" group by i.Book_no,m.member_id;
+-----------+----------------+---------+-----------------+
| member_id | count(Book_no) | Book_no | Membership_type |
+-----------+----------------+---------+-----------------+
|         1 |              1 |     101 | lifetime        |
|         1 |              1 |     104 | lifetime        |
+-----------+----------------+---------+-----------------+

43)  List all member types and how many members are there in each type.?

Ans:  select membership_type, count(member_id) from member group by membership_type;
+-----------------+------------------+
| membership_type | count(member_id) |
+-----------------+------------------+
| lifetime        |                1 |
| Annual          |                1 |
| Quaterly        |                2 |
| Half Yearly     |                2 |
+-----------------+------------------+
4 rows in set (0.00 sec)

44) List first 5 members who had joined library.?
Ans:

mysql> select * from member order by acc_open_date asc limit 5;
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
5 rows in set (0.00 sec)


45) List the members with their member type, who have issued books  during the period 1st December to 31st December.?

Ans: select m.member_id,m.membership_type from member as m join issue as i on  m.member_id=i.member_id
    -> where i.issue_date between  '2006-12-01' AND '2006-12-31';
+-----------+-----------------+
| member_id | membership_type |
+-----------+-----------------+
|         1 | lifetime        |
|         2 | Annual          |
|         1 | lifetime        |
+-----------+-----------------+
3 rows in set (0.00 sec)

46) List all the members who have not returned books yet.?

Ans:  mysql> select * from member as m where m.member_id in(select i.member_id from issue as i where return_date is null);
Empty set (0.00 sec)


47) List all the members who joined library on the same date Garima joined.?
 
mysql> select Member_Name from member where Acc_Open_Date=(select Acc_Open_Date from member where Member_Name ="Garima Sen");
+-------------+
| Member_Name |
+-------------+
| Garima Sen  |
+-------------+

48) List all the members who has issued books from author “Loni” in  the month of December?

Ans: 	select * from member as m where m.member_id in
	(select i.member_id from issue as i  where i.book_no in(select b.book_no from books as b where b.Author="Loni" ) and month (issue_date)=12);

+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         2 | Garima Sen  | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
+-----------+-------------+----------------+---------------+-----------------+-----------+-------------------+----------------+

49) List names of the authors whose books are least issued by  lifetime members. ? 

Ans
select b.author
from books b
join issue i ON b.book_no = i.book_no
join member m ON i.member_id = m.member_id
where m.membership_type = 'Lifetime'
group by b.author
order by count(*) asc
limit 1;




50)  List the names of members who has issued the books whose cost is more than 300 rupees and whose author is “Scott Urman”?


mysql> SELECT Member_name
    -> FROM member m
    -> WHERE m.Member_Id IN (
    ->     SELECT i.Member_Id
    ->     FROM issue i
    ->     WHERE i.Book_no IN (
    ->         SELECT Book_no
    ->         FROM books
    ->         WHERE cost >= 300
    ->         AND Author = 'Scott Urman'
    ->     )
    -> );
+--------------+
| Member_name  |
+--------------+
| Richa Sharma |
| Garima Sen   |
| Mohit Sharma |
+--------------+
3 rows in set (0.00 sec



51) List all lifetime members who joined library during 1st January
2006 to 31st December 2006 but issued only one book?

Ans: 	
mysql> select m.member_id,
    ->        m.member_name
    -> from member m
    -> join  issue i
    ->      ON m.member_id = i.member_id
    -> where  m.membership_type = 'Lifetime'
    ->   and m.Acc_Open_Date BETWEEN '2006-01-01' AND '2006-12-31'
    -> group by m.member_id, m.member_name
    -> having count(i.book_no) = 1;
Empty set (0.00 sec)



52) Modify the Penalty_Amount for Garima Sen to Rs 100.

Ans: 
table member;
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |           NULL |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         4 | Kuldip Singh | Punjab         | 2026-11-15    | Quaterly        |     13400 |                 2 |          40.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
6 rows in set (0.00 sec)


update member set Penalty_Amount="100" where member_name="Garima Sen";
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> table member;
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
| Member_Id | Member_Name  | Member_address | Acc_Open_Date | Membership_type | fess_paid | Max_Books_Allowed | Penalty_Amount |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
|         1 | Richa Sharma | Pune           | 2010-12-15    | lifetime        |     25000 |                 5 |          50.00 |
|         2 | Garima Sen   | Pune           | 2026-01-06    | Annual          |      1000 |                 3 |         100.00 |
|         3 | Mohit Sharma | UttarPradesh   | 2023-12-15    | Quaterly        |     13400 |                 4 |          40.00 |
|         4 | Kuldip Singh | Punjab         | 2026-11-15    | Quaterly        |     13400 |                 2 |          40.00 |
|         5 | Akshar Patel | Gujarat        | 2022-11-15    | Half Yearly     |     13000 |                 2 |          40.00 |
|         6 | Rajiv Patel  | Ahmedabad      | 2024-11-15    | Half Yearly     |     13400 |               110 |          40.00 |
+-----------+--------------+----------------+---------------+-----------------+-----------+-------------------+----------------+
6 rows in set (0.00 sec)








































































